<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VisualCode - Professional Code Exporter</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-solarizedlight.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-coy.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body style="margin:0; padding:0; font-family:'Exo 2', sans-serif; background:#000000; color:#ffffff; min-height:100vh; overflow-x:hidden;">
  <div style="max-width:1200px; margin:0 auto; padding:20px;">
    <header style="text-align:center; margin-bottom:30px; position:relative;">
      <h1 style="font-family:'Orbitron', sans-serif; font-size:3.5rem; font-weight:900; margin:0; background:linear-gradient(90deg, #ff0000, #ffffff, #ff0000); background-size:200% auto; -webkit-background-clip:text; -webkit-text-fill-color:transparent; animation:shine 3s linear infinite;">
        VisualCode
      </h1>
      <p style="margin-top:10px; font-size:1.2rem; color:#ff0000; text-shadow:0 0 10px rgba(255,0,0,0.5);">
        Professional Code Exporter
      </p>
      <div style="position:absolute; top:0; right:0; width:100px; height:100px; background:radial-gradient(circle, rgba(255,0,0,0.3) 0%, rgba(255,255,255,0.1) 70%); border-radius:50%; filter:blur(15px); z-index:-1;"></div>
    </header>
    
    <div id="controlsCtn" style="display:flex; gap:15px; margin-bottom:20px; flex-wrap:wrap; justify-content:center; background:rgba(20,20,20,0.9); backdrop-filter:blur(10px); border-radius:15px; padding:20px; border:1px solid rgba(255,0,0,0.3); box-shadow:0 8px 32px rgba(0,0,0,0.5);">
      <div style="display:flex; flex-direction:column; gap:5px;">
        <label for="languageSelect" style="font-weight:600; color:#ff0000; text-transform:uppercase; font-size:0.9rem;">Language</label>
        <select id="languageSelect" style="padding:10px; border-radius:8px; border:1px solid rgba(255,0,0,0.3); background:rgba(30,30,30,0.9); color:#ffffff; font-family:'Exo 2', sans-serif; transition:all 0.3s ease;">
          <option value="javascript">JavaScript</option>
          <option value="python">Python</option>
          <option value="java">Java</option>
          <option value="css">CSS</option>
          <option value="html">HTML</option>
          <option value="sql">SQL</option>
          <option value="json">JSON</option>
          <option value="bash">Bash</option>
          <option value="c">C</option>
          <option value="cpp">C++</option>
          <option value="csharp">C#</option>
          <option value="go">Go</option>
          <option value="php">PHP</option>
          <option value="ruby">Ruby</option>
          <option value="rust">Rust</option>
          <option value="swift">Swift</option>
          <option value="typescript">TypeScript</option>
          <option value="yaml">YAML</option>
          <option value="markup">Markup</option>
        </select>
      </div>
      
      <div style="display:flex; flex-direction:column; gap:5px;">
        <label for="themeSelect" style="font-weight:600; color:#ff0000; text-transform:uppercase; font-size:0.9rem;">Theme</label>
        <select id="themeSelect" style="padding:10px; border-radius:8px; border:1px solid rgba(255,0,0,0.3); background:rgba(30,30,30,0.9); color:#ffffff; font-family:'Exo 2', sans-serif; transition:all 0.3s ease;">
          <option value="github">GitHub</option>
          <option value="tomorrow">Tomorrow Night</option>
          <option value="okaidia">Okaidia</option>
          <option value="solarized">Solarized Light</option>
          <option value="coy">Coy</option>
          <option value="vscode">VS Code Dark</option>
          <option value="macos">macOS Light</option>
          <option value="macos-dark">macOS Dark</option>
          <option value="neon">Neon Dreams</option>
          <option value="sunset">Sunset Glow</option>
          <option value="ocean">Ocean Depths</option>
          <option value="forest">Forest Mist</option>
          <option value="galaxy">Galaxy</option>
          <option value="cyberpunk">Cyberpunk</option>
          <option value="matrix">Matrix Rain</option>
        </select>
      </div>
      
      <div style="display:flex; flex-direction:column; gap:5px;">
        <label for="lineNumbersCheckbox" style="font-weight:600; color:#ff0000; text-transform:uppercase; font-size:0.9rem;">Line Numbers</label>
        <div style="display:flex; align-items:center; gap:10px; padding:10px; background:rgba(30,30,30,0.9); border-radius:8px; border:1px solid rgba(255,0,0,0.3);">
          <input type="checkbox" id="lineNumbersCheckbox" checked style="width:20px; height:20px; accent-color:#ff0000;">
          <span>Show</span>
        </div>
      </div>
      
      <div style="display:flex; flex-direction:column; gap:5px;">
        <label for="fontSizeSlider" style="font-weight:600; color:#ff0000; text-transform:uppercase; font-size:0.9rem;">Font Size</label>
        <div style="display:flex; align-items:center; gap:10px; padding:10px; background:rgba(30,30,30,0.9); border-radius:8px; border:1px solid rgba(255,0,0,0.3);">
          <input type="range" id="fontSizeSlider" min="10" max="24" value="14" style="width:120px; accent-color:#ff0000;">
          <span id="fontSizeValue" style="font-weight:600; color:#ffffff;">14px</span>
        </div>
      </div>
    </div>
    
    <div id="titleInputCtn" style="margin-bottom:20px; display:flex; justify-content:center;">
      <div style="display:flex; flex-direction:column; gap:5px; width:100%; max-width:400px;">
        <label for="titleInput" style="font-weight:600; color:#ff0000; text-transform:uppercase; font-size:0.9rem;">Window Title</label>
        <input type="text" id="titleInput" value="untitled.js" style="padding:12px; border-radius:8px; border:1px solid rgba(255,0,0,0.3); background:rgba(30,30,30,0.9); color:#ffffff; font-family:'Exo 2', sans-serif; transition:all 0.3s ease;">
      </div>
    </div>
    
    <textarea 
      id="codeInput" 
      placeholder="Paste your code here..." 
      style="width:100%; height:200px; padding:15px; font-family:'Consolas', monospace; font-size:14px; border:1px solid rgba(255,0,0,0.3); border-radius:10px; resize:vertical; background:rgba(30,30,30,0.9); color:#ffffff; transition:all 0.3s ease;"
    ></textarea>
    
    <div style="margin:25px 0; display:flex; gap:15px; justify-content:center;">
      <button 
        id="updateBtn" 
        style="padding:12px 30px; background:linear-gradient(90deg, #ff0000, #990000); color:white; border:none; border-radius:50px; cursor:pointer; font-weight:700; font-family:'Orbitron', sans-serif; text-transform:uppercase; letter-spacing:1px; box-shadow:0 4px 15px rgba(255,0,0,0.4); transition:all 0.3s ease;"
      >
        Update Preview
      </button>
      <button 
        id="exportBtn" 
        style="padding:12px 30px; background:linear-gradient(90deg, #ffffff, #cccccc); color:black; border:none; border-radius:50px; cursor:pointer; font-weight:700; font-family:'Orbitron', sans-serif; text-transform:uppercase; letter-spacing:1px; box-shadow:0 4px 15px rgba(255,255,255,0.4); transition:all 0.3s ease;"
      >
        Export HD Image
      </button>
    </div>
    
    <div id="previewCtn" style="margin:30px 0; border-radius:15px; overflow:hidden; background:rgba(20,20,20,0.9); backdrop-filter:blur(10px); box-shadow:0 15px 35px rgba(0,0,0,0.8), 0 0 30px rgba(255,0,0,0.3); border:1px solid rgba(255,0,0,0.3); transition:all 0.5s ease;">
      <div id="windowFrameEl" style="display:flex; flex-direction:column; height:100%;">
        <div id="titleBarEl" style="display:flex; align-items:center; padding:12px 20px; background: linear-gradient(to bottom, #1a1a1a, #0a0a0a); border-bottom:1px solid rgba(255,0,0,0.3);">
          <div style="display:flex; gap:8px;">
            <div style="width:14px; height:14px; border-radius:50%; background-color:#ff0000; box-shadow:0 0 5px rgba(255,0,0,0.5);"></div>
            <div style="width:14px; height:14px; border-radius:50%; background-color:#ffffff; box-shadow:0 0 5px rgba(255,255,255,0.5);"></div>
            <div style="width:14px; height:14px; border-radius:50%; background-color:#ff0000; box-shadow:0 0 5px rgba(255,0,0,0.5);"></div>
          </div>
          <div id="windowTitleEl" style="flex:1; text-align:center; font-size:14px; color:#ffffff; font-weight:600; font-family:'Exo 2', sans-serif; text-shadow:0 0 10px rgba(255,0,0,0.5);">untitled.js</div>
        </div>
        <div id="codeContentEl" style="flex:1; padding:0; overflow:auto;">
          <pre id="codeDisplay" style="margin:0; padding:25px; font-family:'Consolas', monospace; font-size:14px; line-height:1.6; overflow-x:auto; background-color:#000000; color:#ffffff; border-radius:0 0 15px 15px;"><code class="language-javascript"></code></pre>
        </div>
      </div>
    </div>
    
    <div id="loadingIndicator" hidden style="position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:rgba(20,20,20,0.95); backdrop-filter:blur(10px); color:white; padding:25px; border-radius:15px; z-index:1000; box-shadow:0 10px 30px rgba(0,0,0,0.8), 0 0 20px rgba(255,0,0,0.3); border:1px solid rgba(255,0,0,0.3);">
      <div style="display:flex; align-items:center; gap:15px;">
        <div style="width:30px; height:30px; border:3px solid rgba(255,0,0,0.3); border-top:3px solid #ff0000; border-radius:50%; animation:spin 1s linear infinite;"></div>
        <span style="font-family:'Orbitron', sans-serif; font-weight:700; text-transform:uppercase; letter-spacing:1px;">Generating HD image...</span>
      </div>
    </div>
    
    <style>
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      @keyframes shine {
        0% { background-position:0% 50%; }
        50% { background-position:100% 50%; }
        100% { background-position:0% 50%; }
      }
      
      @keyframes pulse {
        0% { box-shadow:0 0 0 0 rgba(255,0,0,0.7); }
        70% { box-shadow:0 0 0 10px rgba(255,0,0,0); }
        100% { box-shadow:0 0 0 0 rgba(255,0,0,0); }
      }
      
      /* Theme styles */
      .theme-github {
        --code-bg: #f6f8fa;
        --bg-color: #ffffff;
        --text-color: #24292e;
      }
      
      .theme-tomorrow {
        --code-bg: #2d2d2d;
        --bg-color: #282c34;
        --text-color: #cccccc;
      }
      
      .theme-okaidia {
        --code-bg: #272822;
        --bg-color: #1e1e1e;
        --text-color: #f8f8f2;
      }
      
      .theme-solarized {
        --code-bg: #fdf6e3;
        --bg-color: #eee8d5;
        --text-color: #586e75;
      }
      
      .theme-coy {
        --code-bg: #f7f7f7;
        --bg-color: #ffffff;
        --text-color: #000000;
      }
      
      .theme-vscode {
        --code-bg: #1e1e1e;
        --bg-color: #252526;
        --text-color: #d4d4d4;
      }
      
      .theme-macos {
        --code-bg: #ffffff;
        --bg-color: #f0f0f0;
        --text-color: #333333;
      }
      
      .theme-macos-dark {
        --code-bg: #292a2b;
        --bg-color: #1c1c1e;
        --text-color: #f0f0f0;
      }
      
      .theme-neon {
        --code-bg: #0d0d1a;
        --bg-color: #0a0a15;
        --text-color: #00ffcc;
        --gradient: linear-gradient(135deg, #0d0d1a, #1a1a3a);
      }
      
      .theme-sunset {
        --code-bg: #2a1810;
        --bg-color: #1f1410;
        --text-color: #ff9e6d;
        --gradient: linear-gradient(135deg, #2a1810, #3d2418);
      }
      
      .theme-ocean {
        --code-bg: #0a1929;
        --bg-color: #071525;
        --text-color: #4fc3f7;
        --gradient: linear-gradient(135deg, #0a1929, #0d2744);
      }
      
      .theme-forest {
        --code-bg: #0d1b0d;
        --bg-color: #0a150a;
        --text-color: #8bc34a;
        --gradient: linear-gradient(135deg, #0d1b0d, #132613);
      }
      
      .theme-galaxy {
        --code-bg: #0f0c29;
        --bg-color: #0a081f;
        --text-color: #bb86fc;
        --gradient: linear-gradient(135deg, #0f0c29, #24243e);
      }
      
      .theme-cyberpunk {
        --code-bg: #1a0033;
        --bg-color: #120024;
        --text-color: #ff00ff;
        --gradient: linear-gradient(135deg, #1a0033, #330066);
      }
      
      .theme-matrix {
        --code-bg: #0d1f0d;
        --bg-color: #0a1a0a;
        --text-color: #00ff00;
        --gradient: linear-gradient(135deg, #0d1f0d, #0f2f0f);
      }
      
      /* Hover effects */
      button:hover {
        transform: translateY(-3px);
        box-shadow:0 7px 20px rgba(255,0,0,0.5);
      }
      
      select:hover, input:hover, textarea:hover {
        border-color: rgba(255,0,0,0.6);
        box-shadow:0 0 10px rgba(255,0,0,0.2);
      }
      
      #previewCtn:hover {
        box-shadow:0 20px 40px rgba(0,0,0,0.9), 0 0 40px rgba(255,0,0,0.4);
      }
    </style>
    
    <script>
      // Theme definitions
      const themes = {
        github: {
          codeBg: '#f6f8fa',
          bg: '#ffffff',
          prismTheme: '',
          textColor: '#24292e'
        },
        tomorrow: {
          codeBg: '#2d2d2d',
          bg: '#282c34',
          prismTheme: 'prism-tomorrow',
          textColor: '#cccccc'
        },
        okaidia: {
          codeBg: '#272822',
          bg: '#1e1e1e',
          prismTheme: 'prism-okaidia',
          textColor: '#f8f8f2'
        },
        solarized: {
          codeBg: '#fdf6e3',
          bg: '#eee8d5',
          prismTheme: 'prism-solarizedlight',
          textColor: '#586e75'
        },
        coy: {
          codeBg: '#f7f7f7',
          bg: '#ffffff',
          prismTheme: 'prism-coy',
          textColor: '#000000'
        },
        vscode: {
          codeBg: '#1e1e1e',
          bg: '#252526',
          prismTheme: 'prism-tomorrow',
          textColor: '#d4d4d4'
        },
        macos: {
          codeBg: '#ffffff',
          bg: '#f0f0f0',
          prismTheme: '',
          textColor: '#333333'
        },
        'macos-dark': {
          codeBg: '#292a2b',
          bg: '#1c1c1e',
          prismTheme: 'prism-tomorrow',
          textColor: '#f0f0f0'
        },
        neon: {
          codeBg: '#0d0d1a',
          bg: '#0a0a15',
          prismTheme: '',
          textColor: '#00ffcc',
          gradient: 'linear-gradient(135deg, #0d0d1a, #1a1a3a)'
        },
        sunset: {
          codeBg: '#2a1810',
          bg: '#1f1410',
          prismTheme: '',
          textColor: '#ff9e6d',
          gradient: 'linear-gradient(135deg, #2a1810, #3d2418)'
        },
        ocean: {
          codeBg: '#0a1929',
          bg: '#071525',
          prismTheme: '',
          textColor: '#4fc3f7',
          gradient: 'linear-gradient(135deg, #0a1929, #0d2744)'
        },
        forest: {
          codeBg: '#0d1b0d',
          bg: '#0a150a',
          prismTheme: '',
          textColor: '#8bc34a',
          gradient: 'linear-gradient(135deg, #0d1b0d, #132613)'
        },
        galaxy: {
          codeBg: '#0f0c29',
          bg: '#0a081f',
          prismTheme: '',
          textColor: '#bb86fc',
          gradient: 'linear-gradient(135deg, #0f0c29, #24243e)'
        },
        cyberpunk: {
          codeBg: '#1a0033',
          bg: '#120024',
          prismTheme: '',
          textColor: '#ff00ff',
          gradient: 'linear-gradient(135deg, #1a0033, #330066)'
        },
        matrix: {
          codeBg: '#0d1f0d',
          bg: '#0a1a0a',
          prismTheme: '',
          textColor: '#00ff00',
          gradient: 'linear-gradient(135deg, #0d1f0d, #0f2f0f)'
        }
      };
      
      // Initialize with default values
      codeDisplay.style.backgroundColor = '#000000';
      previewCtn.style.backgroundColor = '#0a0a0a';
      previewCtn.classList.add('theme-cyberpunk');
      
      // Update preview when settings change
      function updatePreview() {
        const code = codeInput.value;
        const language = languageSelect.value;
        const theme = themeSelect.value;
        const showLineNumbers = lineNumbersCheckbox.checked;
        const fontSize = fontSizeSlider.value;
        const title = titleInput.value;
        
        // Update font size display
        fontSizeValue.textContent = fontSize + 'px';
        
        // Get theme settings
        const themeSettings = themes[theme];
        
        // Apply theme classes
        previewCtn.className = '';
        previewCtn.classList.add(`theme-${theme}`);
        
        // Apply styles
        codeDisplay.style.backgroundColor = themeSettings.codeBg;
        codeDisplay.style.fontSize = fontSize + 'px';
        previewCtn.style.backgroundColor = themeSettings.bg;
        codeDisplay.style.color = themeSettings.textColor;
        
        // Apply gradient background if available
        if (themeSettings.gradient) {
          previewCtn.style.background = themeSettings.gradient;
        } else {
          previewCtn.style.background = '';
        }
        
        // Update window title
        windowTitleEl.textContent = title;
        
        // Apply line numbers
        if (showLineNumbers) {
          codeDisplay.classList.add('line-numbers');
        } else {
          codeDisplay.classList.remove('line-numbers');
        }
        
        // Set language and code
        const codeElement = codeDisplay.querySelector('code');
        codeElement.className = `language-${language} ${themeSettings.prismTheme}`;
        codeElement.textContent = code;
        
        // Apply syntax highlighting
        Prism.highlightElement(codeElement);
        
        // Add animation effect
        previewCtn.style.animation = 'pulse 1s ease';
        setTimeout(() => {
          previewCtn.style.animation = '';
        }, 1000);
      }
      
      // Event listeners
      updateBtn.onclick = updatePreview;
      languageSelect.onchange = updatePreview;
      themeSelect.onchange = updatePreview;
      lineNumbersCheckbox.onchange = updatePreview;
      fontSizeSlider.oninput = updatePreview;
      titleInput.oninput = updatePreview;
      
      // Export functionality
      exportBtn.onclick = async function() {
        if (!codeInput.value.trim()) {
          alert('Please paste some code first!');
          return;
        }
        
        // Show loading indicator
        loadingIndicator.hidden = false;
        exportBtn.disabled = true;
        
        try {
          // Use html2canvas to capture the preview
          const canvas = await html2canvas(previewCtn, {
            scale: 3, // Higher scale for better quality
            backgroundColor: null,
            logging: false,
            useCORS: true
          });
          
          // Convert to data URL
          const dataUrl = canvas.toDataURL('image/png');
          
          // Create download link
          const link = document.createElement('a');
          link.download = 'code-export.png';
          link.href = dataUrl;
          link.click();
        } catch (error) {
          console.error('Export failed:', error);
          alert('Failed to generate image. Please try again.');
        } finally {
          // Hide loading indicator
          loadingIndicator.hidden = true;
          exportBtn.disabled = false;
        }
      };
      
      // Initialize preview on page load
      updatePreview();
    </script>
  </div>
</body>
</html>
